<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>State Of React &#8211; James K Nelson</title>
	<atom:link href="/category/state-of-react/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description></description>
	<lastBuildDate>Mon, 29 Aug 2016 21:28:52 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.9.3</generator>
	<item>
		<title>The 5 Types Of React Application State</title>
		<link>/5-types-react-application-state/</link>
					<comments>/5-types-react-application-state/#comments</comments>
		
		<dc:creator><![CDATA[James K Nelson]]></dc:creator>
		<pubDate>Mon, 29 Aug 2016 06:27:34 +0000</pubDate>
				<category><![CDATA[Flux]]></category>
		<category><![CDATA[React]]></category>
		<category><![CDATA[State Of React]]></category>
		<guid isPermaLink="false">/?p=1081</guid>

					<description><![CDATA[<p>I don&#8217;t know about you, but when I started writing React apps, I struggled to decide where my state should go. No matter how I re-arranged setState calls, things never felt quite right. And maybe that is why I got so excited when I found Redux. Redux gave me a single place to put all... <a class="more-link" href="/5-types-react-application-state/">Continue reading <span class="meta-nav">&#8594;</span></a></p>
<p>The post <a rel="nofollow" href="/5-types-react-application-state/">The 5 Types Of React Application State</a> appeared first on <a rel="nofollow" href="/">James K Nelson</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>I don&#8217;t know about you, but when I started writing React apps, <a href="/state-react-1-stateless-react-app/">I struggled</a> to decide where my state should go. No matter how I re-arranged <code>setState</code> calls, things never felt quite right.</p>
<p><img src="/wp-content/uploads/2016/08/mess.png" alt="&quot;Messy state&quot;" /></p>
<p>And maybe that is why I got so excited when I found Redux. Redux gave me <a href="/state-react-2-inception-redux/">a single place to put all my state</a>. Which sounded great in theory.</p>
<p><img src="/wp-content/uploads/2016/08/statebox.png" alt="&quot;What if&quot;" /></p>
<p>But then I realised that having one spot to put things doesn&#8217;t necessarily make them easy to get to.</p>
<p><img src="/wp-content/uploads/2016/08/statebox-inside.png" alt="&quot;Still messy&quot;" /></p>
<p>It turns out that I needed more than just a place to put things. I also need a system for putting them in the right place.</p>
<p><img src="/wp-content/uploads/2016/08/drawers.png" alt="&quot;Banzai!&quot;" /></p>
<p>For me, that system came from splitting my state into five categories. It turned the problem of deciding &#8220;how does this piece of state relate to all the other state&#8221;, into the problem of deciding &#8220;what type of state is this&#8221;. And as it turns out, this is a <em>whole lot easier.</em></p>
<p><span id="more-1081"></span></p>
<p>So here&#8217;s the deal. React apps have five types of state. Each type of state has a number of rules which it follows. It interacts with the other types of state in well defined ways &#8212; <em>as long as it follows the rules.</em> And based on these rules, you&#8217;ll find that there are ways of storing the state which <em>just make sense</em>.</p>
<p>So without further ado, your five types of state are:</p>
<ul>
<li>Data</li>
<li>Communication</li>
<li>Control</li>
<li>Session</li>
<li>Location</li>
</ul>
<p>And of these five, &#8220;Data&#8221; is the one which really needs a better name. It also happens to be the easiest one to explain. So let&#8217;s dig in.</p>
<h2>Data</h2>
<p>Data state covers information which your application temporarily stores about the big wide world. That is, it covers your business data.</p>
<p>Now let&#8217;s say you&#8217;re building something hip and cool like an invoicing application. Examples of the Data state for you application will include things received from the server &#8212; invoices, contacts, receipts, etc. And, as all of your data comes from the outside world, it is probably going to have some sort of identifier which you use to request it:</p>
<p><em><code>GET</code> the <code>/invoice</code> with <code>?id=happiness</code>, or something</em></p>
<p>Actually, I&#8217;m going to enshrine this as <strong>The Rule of Data state</strong>:</p>
<p><em>Every piece of received Data has a <strong>type</strong>, and a <strong>selector</strong> which exactly specifies which data was received.</em></p>
<p>This fact makes it easy to design a Redux store for our data; at minimum, it is going to include a way to map a type and id to a received object. It will also include actions to update the store with received objects.</p>
<p><img src="/wp-content/uploads/2016/08/shelf.png" alt="&quot;Data goes on shelves&quot;" /></p>
<p>And this is awesome, because now we have a data store which can be accessed from anywhere within the application using <a href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options">connect</a>. Also, as long as your data follows the rule of data state, you can spice things up with indexes and custom higher order components too.</p>
<p>Of course, Data doesn&#8217;t just magically appear in an application. We need to request it, and then wait until the request succeeds or fails. And that is where Communication state comes in.</p>
<h2>Communication state</h2>
<p>This type of state covers the seemingly simple yet somewhat thorny information which represents things like loading spinners and error messages. It also covers the state which you may not have realised you introduced into your application when you passed a callback to a HTTP request.</p>
<p>But the above explanation is pretty complex. To simplify things, lets forget about what Communication state <em>does</em>, and instead think about what it is. In fact, <strong>The Rule of Communication state</strong> covers this:</p>
<p><em>Communication state is the status of any not-yet-complete requests to other services.</em></p>
<p>This means that all of the following are communication state:</p>
<ul>
<li>The type/selector for any Data you expect to receive</li>
<li>The type, selector and expected change of any operations you have requested on Data</li>
<li>The error messages for anything which didn&#8217;t go quite as planned</li>
</ul>
<p><img src="/wp-content/uploads/2016/08/inoutbox.png" alt="&quot;Communications goes in queues&quot;" /></p>
<p>Defining Communication state this way has two major benefits:</p>
<script src="https://app.convertkit.com/assets/CKJS4.js?v=18"></script>
<link rel="stylesheet" href="ck_form.html" />
<div class="ck_form single_line">

  <div class="ck_form_fields">
  
    <h3>Speaking of Communication benefits...</h3>

    <div id='ck_success_msg'  style='display:none;'>
      <p>Thanks! Please check your email for the link to your cheatsheets.</p>
    </div>

    <!--  Form starts here  -->
    <form id="ck_subscribe_form" class="ck_subscribe_form" action="https://app.convertkit.com/landing_pages/92739/subscribe" data-remote="true">
      <input type="hidden" name="id" value="92739" id="landing_page_id"></input>
      <div class="ck_errorArea">
        <div id="ck_error_msg" style="display:none">
          <p>There was an error submitting your subscription. Please try again.</p>
        </div>
      </div>
        <div>
          <label class="ck_label" for="ck_firstNameField" style="display:none">First Name</label>
        
          <input type="text" name="first_name" placeholder="First name" class="ck_first_name" id="ck_firstNameField" required></input>
        </div>
        <div class="field">
          <label class="ck_label" for="ck_emailField" style="display:none">Email Address</label>
        
          <input type="email" name="email" placeholder="Email address" class="ck_email_address" id="ck_emailField" required></input>
        </div>

        <button class="subscribe_button ck_subscribe_button btn fields" id='ck_subscribe_button'>
          Subscribe to get five free cheatsheets!
        </button>
    </form>
  </div>
 </div>
 <style type="text/css">
.ck_form.single_line {
  /* divider image */
  background: #f9f9f9;
  font-family: 'Helvetica Neue', Helvetica, Arial, Verdana, sans-serif;
  line-height: 1.5em;
  overflow: hidden;
  color: #666;
  font-size: 16px;
  border: solid 1px #d1d1d1;
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none;
  clear: both;
  margin: 20px auto;
  text-align: center;
  width: 85%;
  border-radius: 6px;
}


.ck_form.single_line h3, #content .ck_form.single_line h3 { 
  text-align: center; 
  margin: 0px 0px 10px; 
  font-size: 24px;
}

.ck_form.single_line p {
  padding: 0px;
}

.ck_form * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

#ck_subscribe_form {
  clear: both;
}

.ck_form.single_line .ck_form_fields {
  width: 100%;
  float: left;
  padding: 24px 0;
}
/* Form fields */

.ck_errorArea {
  display: none; /* temporary */
}

#ck_success_msg {
  margin: 0 30px;
  padding: 0 10px;
  border: solid 1px #ddd;
  background: #eee;
}

.ck_form.single_line input[type="text"], .ck_form.single_line input[type="email"] {
  font-size: 18px;
  padding: 10px 8px;
  width: 68%;
  border: 1px solid #d6d6d6; /* stroke */
  -moz-border-radius: 3px;
  -webkit-border-radius: 3px;
  border-radius: 3px; /* border radius */
  background-color: #fff; /* layer fill content */
  height: auto;
  margin: 5px 0;
  height: 42px;
}

.ck_form input[type="text"]:focus, .ck_form input[type="email"]:focus {
  outline: none;
  border-color: #aaa;
} 

.ck_form.single_line .ck_checkbox {
  display: none;
}

.ck_form.single_line .ck_subscribe_button {
    color: #fff;
    margin: 0px;
    padding:  11px 22px;
    font-size: 18px;
    background: #b30e2f;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border-radius: 3px; /* border radius */
    cursor: pointer;
    border: none;
    text-shadow: none;
    margin: 10px 0 0;
    height: 42px;
    width: auto;
  }
  
  
.ck_form.single_line .ck_guarantee {
  color: #626262;
  font-size: 15px;
  text-align: center;
  padding: 15px 0px 0px;
  display: block;
  clear: both;
}
 </style>
<ol>
<li>You can store it with a simple Redux reducer which manages an array of Request objects</li>
<li>You can now compute the status (<code>retrieving</code>, <code>updating</code>, <code>fuckwhathappened</code>, etc.) of any Data in your store with a <em>pure function</em> of your Data and Communications state.</li>
<li>No srsly. That means that now you never have to write a <code>setState({ saving: trueorfalse })</code> ever again.</li>
</ol>
<p>So both Communications state and Data state can be implemented as independent stores, managed by Redux. They&#8217;re both accessible to your entire application using <code>connect</code>. I&#8217;m starting to see a pattern here &#8212; maybe all state fits well into a certain type of Reducer which the entire application can make use of it? <em>If only it were that simple.</em></p>
<h2>Control state</h2>
<p>In contrast to the above two types of state, Control state <em>does not</em> represent the application&#8217;s environment. Instead, it refers to the state which the user has input into the app. Form inputs, selected items, things like that.</p>
<p><em>Things like wha?</em> Yeah, so you may have noticed that forms and selected items are completely different types of information. Selected items probably take the form of a single string representing an id, while forms can be huge nested objects. And that is the thing about control state &#8212; its shape doesn&#8217;t really follow any pattern.</p>
<p>Luckily though, it <em>does</em> follow another type of pattern. You see, the thing about control state is that it is generally specific to a single view. Or screen. Or <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.tl1cvdgxg">container component</a>. Which brings us to <strong>The Rule of Control state</strong>:</p>
<p><em>Control State is state which is specific to a given container component, and which is not stored in the screen&#8217;s URL or in the HTML5 History API.</em></p>
<p><img src="/wp-content/uploads/2016/08/controlbox.png" alt="&quot;Each view's control state gets its own box&quot;" /></p>
<p>Great, so we have a pattern to work with. Now how do we use that pattern to write Redux reducers for our views? Have a little think about it, and once you&#8217;ve got an answer, check it by hovering your mouse over or touching the box below.</p>
<div class="spoiler">
<div class="spoiler-mask"></div>
You don&#8217;t.
</div>
<p>Did you think about that for a while? Sorry. But I think this is an important point to make. And Dan Abramov, author of Redux, <a href="https://twitter.com/dan_abramov/status/699241546248536064">seems to think so too</a>:</p>
<blockquote>
<p>Don’t use Redux until you have problems with vanilla React</p>
</blockquote>
<p>Remember how Data and Communications state needs to be available to the entire application? Control state only needs to be available to a specific view. And that means that <code>setState</code> &#8212; i.e. vanilla React &#8212; is <em>perfect</em>.</p>
<p>Actually, I just glossed over an important point, so let me spell it out a little better:</p>
<p><em>You don&#8217;t have to use the same method for storing every type of state. Seriously.</em></p>
<p>Do you have state which has a predictable shape and needs to be available everywhere within your application? Use Redux. What about state with an unpredictable shape which is limited to one view? Use <code>setState</code>. Maybe you have state which needs to be available everywhere but has an unpredictable shape? Uhhh&#8230;</p>
<h2>Session state</h2>
<p>When you have information which needs to be available application-wide, but its shape is less well defined than your project&#8217;s schedule, it is probably Session state.</p>
<p>Or put it another, and we get <strong>The First Rule of Session state</strong>:</p>
<p><em>Session state contains information about the human being which is currently using your application.</em></p>
<p>This includes the obvious stuff &#8211; their user id, permissions, etc. But it also may include a user&#8217;s preferences for how the application should work.</p>
<p>Now one thing about session state is that parts of it can be pretty similar to Control state. For example, you may have a piece of Control state which represents which parts of a tree view are collapsed or expanded. You may also have a piece of Session state which represents &#8230; exactly the same thing. But I promise you there is a difference. And you can probably figure it out yourself with <strong>The Second Rule of Session State</strong>:</p>
<p><em>Session state is only ever read when a component is mounted.</em></p>
<p>Of course, this means that the Session version of your tree view&#8217;s expansion is a <em>copy</em> of the Control state. Sure, your view can <em>write</em> to the session whenever it wants. But it only reads from it to initialise the view. Or to put it another way: Session state can be used to save preferences.</p>
<p>Ok, cool. So how does session state get stored? Like this:</p>
<p><img src="/wp-content/uploads/2016/08/cloud.png" alt="&quot;Session state comes from above&quot;" /></p>
<p>Session state rains down from above. In the React world, that means it is probably just a plain old object which has found its way into your component&#8217;s <a href="https://facebook.github.io/react/docs/context.html">context</a>. You&#8217;ll probably want some way to make sure it doesn&#8217;t disappear between page loads, but I&#8217;m sure you can figure that out. But before you do, let&#8217;s talk about the baddest, meanest state of them all.</p>
<h2>Location state</h2>
<p>What counts as <em>location</em>? Intuitively, I&#8217;d say &#8220;anything which you can give someone concrete directions to&#8221;. But a wishy washy explanation like that isn&#8217;t going to get us very far. So let&#8217;s try something concrete:</p>
<p><em>Location state is that UTF-8 mess which appears in your URL bar.</em></p>
<p>This definition has a number of things going for it:</p>
<ul>
<li>That UTF-8 mess definitely represents the state of your application</li>
<li>Sharing it between users is kind of like giving directions</li>
<li>The L in URL stands for <em>Locatooor</em></li>
</ul>
<p>But as great as this definition is, it isn&#8217;t really complete. For a start, it doesn&#8217;t take into account the fact that you can give people directions to parts of your application which don&#8217;t <em>have</em> a unique URL. Also, the HTML5 History API actually lets you store state separately from the URL. Aptly, you do this by calling a method named <code>pushState</code>.</p>
<p>To be honest, I haven&#8217;t really succeeded in pinning down an accurate definition of Location state. So I&#8217;ve gone with a pragmatic one instead. And it also happens to be <strong>The Rule of Location state</strong>:</p>
<p><em>Location state is the information stored in the URL</em> and <em>the <a href="https://developer.mozilla.org/en/docs/Web/API/History">HTML5 History</a> <code>state</code> object</em></p>
<p>Handily, this definition covers both the <em>type</em> of information which is stored, as well as the <em>method</em> for storing it. Unfortunately, it doesn&#8217;t help us with the structure. Instead, it forces us into storing one of the most important pieces of state in our entire application as a bloody <em>string</em>.</p>
<p>And it goes without saying that no competent webmaster is going to build a large scale web application with routing based on <code>window.location.hash.indexOf</code>.  But one of the funny things about URLs is that while they&#8217;re stored as strings, they don&#8217;t represent strings. They actually represent a hierarchy. And that happens to overlap with your application&#8217;s component hierarchy.</p>
<p><img src="/wp-content/uploads/2016/08/tree.png" alt="&quot;Location is a subset of a tree&quot;" /></p>
<p>In fact, by combining the hierarchy stored in URLs with the ability to store extra location with <code>pushState</code>, you can build a <em>location tree</em> which maps to a (hopefully proper) subset of your application&#8217;s component tree. Or to put it another way, your location state ends up being a set of flags which enable and disable branches of your application. Simple, right?</p>
<p>It would be, if it wasn&#8217;t for side effects.</p>
<h2>Side effects</h2>
<p>Of our five types of state, four of them mostly mind their own business. Changes to Data, Communication, Control and Session state will <em>generally</em> not cause other types of state to change as well.</p>
<p>Location state is a whole different ball game. Every time it changes, you&#8217;ll find other state changing too:</p>
<ul>
<li>Changing Location mounts container components, causing Control state to change</li>
<li>Changing Location makes HTTP requests which cause Communication state to change, before also causing Data state to change</li>
<li><em>Changing Location can even cause Location to change!</em> That&#8217;s what redirects do.</li>
</ul>
<p>So here&#8217;s the thing about having your state structured well: you suddenly realise how much of a pain in the arse uncontrolled side effects are.</p>
<p>Luckily, they don&#8217;t have to stay uncontrolled. That&#8217;s what <em>controllers</em> are for. Want to find out how to use them? Then subscribe to make sure you don&#8217;t miss out on Episode 4 of <em>State Of React</em>, where I discuss the C in MVC! I&#8217;ll even throw in 5 free ReactJS and JavaScript cheatsheets:</p>
<script src="https://app.convertkit.com/assets/CKJS4.js?v=21"></script>

<div class="ck_form ck_vertical_subscription_form">
  <div class="ck_form_content">
      <h3 class="ck_form_title">I will send you useful articles, cheatsheets and code.</h3>
      <div class="ck_description">
          I won't send you useless inbox filler. <em>No spam, ever.</em>
      </div>
  </div>

  <div class="ck_form_fields">

    <div id='ck_success_msg'  style='display:none;'>
      <p>Thanks! Please check your email for the link to your cheatsheets.</p>
    </div>

    <!--  Form starts here  -->
    <form id="ck_subscribe_form" class="ck_subscribe_form" action="https://app.convertkit.com/landing_pages/4375/subscribe" data-remote="true">
      <input type="hidden" value="{&quot;embed_style&quot;:&quot;inline&quot;,&quot;embed_trigger&quot;:&quot;scroll_percentage&quot;,&quot;scroll_percentage&quot;:&quot;70&quot;,&quot;delay_seconds&quot;:&quot;10&quot;,&quot;display_position&quot;:&quot;br&quot;,&quot;display_devices&quot;:&quot;all&quot;,&quot;days_no_show&quot;:&quot;15&quot;,&quot;converted_behavior&quot;:&quot;show&quot;}" id="ck_form_options"></input>
      <input type="hidden" name="id" value="4375" id="landing_page_id"></input>
      <div class="ck_errorArea">
        <div id="ck_error_msg" style="display:none">
          <p>There was an error submitting your subscription. Please try again.</p>
        </div>
      </div>
      <div class="ck_control_group ck_first_name_field_group">
        <label class="ck_label" for="ck_firstNameField">First Name</label>
        <input type="text" name="first_name" class="ck_first_name" id="ck_firstNameField"></input>
      </div>
      <div class="ck_control_group ck_email_field_group">
        <label class="ck_label" for="ck_emailField">Email Address</label>
          <input type="email" name="email" class="ck_email_address" id="ck_emailField" required></input>
      </div>
      <label class='ck_checkbox' style='display:none;'>
        <input class="optIn ck_course_opted" name='course_opted' type="checkbox" id="optIn" checked />
        <span class='ck_opt_in_prompt'>I'd like to receive the free email course.</span>
      </label>

      <button class="subscribe_button ck_subscribe_button btn fields" id='ck_subscribe_button'>
       Join over 13,000 subscribers
      </button>
      <span class="ck_guarantee">
        Unsubscribe at any time.
      </span>
    </form>
  </div>

 </div>


<style type="text/css">/* Layout */
  .ck_form {
  /* divider image */
  background: #fff url(data:image/gif;base64,R0lGODlhAQADAIABAMzMzP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MUQ5NjM5RjgxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MUQ5NjM5RjkxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxRDk2MzlGNjFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxRDk2MzlGNzFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAABAAMAAAICRFIAOw==) repeat-y center top;
  font-family: 'Helvetica Neue', Helvetica, Arial, Verdana, sans-serif;
  line-height: 1.5em;
  overflow: hidden;
  color: #666;
  font-size: 16px;
  border-top: solid 20px #3071b0;
  border-top-color: #b30e2f;
  border-bottom: solid 10px #3d3d3d;
  border-bottom-color: #5f0719;
  -webkit-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  -moz-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  clear: both;
  margin: 20px 0px;
}

.ck_form * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

#ck_subscribe_form {
  clear: both;
}

/* Element Queries — uses JS */

.ck_form_content, .ck_form_fields {
  width: 50%;
  float: left;
  padding: 5%;
}

.ck_form.ck_horizontal {
}

.ck_form_content {
  border-bottom: none;
}

.ck_form.ck_vertical {
  background: #fff;
}

.ck_vertical .ck_form_content, .ck_vertical .ck_form_fields {
  padding: 10%;
  width: 100%;
  float: none;
}

.ck_vertical .ck_form_content {
  border-bottom: 1px dotted #aaa;
  overflow: hidden;
}

/* Trigger the vertical layout with media queries as well */

@media all and (max-width: 499px) {

  .ck_form {
    background: #fff;
  }

  .ck_form_content, .ck_form_fields {
    padding: 10%;
    width: 100%;
    float: none;
  }

  .ck_form_content {
    border-bottom: 1px dotted #aaa;
  }

}

/* Content */

.ck_form_content h3 {
  margin: 0px 0px 15px;
  font-size: 24px;
  padding: 0px;
}


.ck_form_content p {
  font-size: 14px;
}

.ck_image {
  float: left;
  margin-right: 5px;
}

/* Form fields */

.ck_errorArea {
  display: none;
}

#ck_success_msg {
  padding: 10px 10px 0px;
  border: solid 1px #ddd;
  background: #eee;
}

.ck_label {
  font-size: 14px;
  font-weight: bold;
}

.ck_form input[type="text"], .ck_form input[type="email"] {
  font-size: 14px;
  padding: 10px 8px;
  width: 100%;
  border: 1px solid #d6d6d6; /* stroke */
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  border-radius: 4px; /* border radius */
  background-color: #f8f7f7; /* layer fill content */
  margin-bottom: 5px;
  height: auto;
}

.ck_form input[type="text"]:focus, .ck_form input[type="email"]:focus {
  outline: none;
  border-color: #aaa;
}

.ck_checkbox {
  padding: 10px 0px 10px 20px;
  display: block;
  clear: both;
}

.ck_checkbox input.optIn {
  margin-left: -20px;
  margin-top: 0;
}
.ck_form .ck_opt_in_prompt {
  margin-left: 4px;
}
.ck_form .ck_opt_in_prompt p {
  display: inline;
}

.ck_form .ck_subscribe_button {
    width: 100%;
    color: #fff;
    margin: 10px 0px 0px;
    padding:  10px 0px;
    font-size: 18px;
    background: #b30e2f;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px; /* border radius */
    cursor: pointer;
    border: none;
    text-shadow: none;
  }


.ck_form .ck_guarantee {
  color: #626262;
  font-size: 12px;
  text-align: center;
  padding: 5px 0px;
  display: block;
}

.ck_form .ck_powered_by {
  display: block;
  color: #aaa;
}

.ck_form .ck_powered_by:hover {
  display: block;
  color: #444;
}

.ck_converted_content {
  display: none;
  padding: 5%;
  background: #fff;
}



</style>
<p>One more thing &#8211; <em>I love hearing your questions, offers and opinions.</em> If you have something to say, leave a comment or send me an e-mail at <a href="mailto:james@jamesknelson.com">james@jamesknelson.com</a>. I&#8217;m looking forward to hearing from you!</p>
<h2>More Reading</h2>
<ul>
<li><a href="/state-react-1-stateless-react-app/">State of React #1: A stateless React app?</a></li>
<li>
<p><a href="/state-react-2-inception-redux">State of React #2: From Inception to Redux</a></p>
</li>
<li>
<p><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">Presentational and Container components</a></p>
</li>
<li><a href="https://facebook.github.io/react/docs/context.html">React Context</a></li>
<li><a href="https://developer.mozilla.org/en/docs/Web/API/History">The HTML5 History API</a></li>
</ul>
<p>The post <a rel="nofollow" href="/5-types-react-application-state/">The 5 Types Of React Application State</a> appeared first on <a rel="nofollow" href="/">James K Nelson</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>/5-types-react-application-state/feed/</wfw:commentRss>
			<slash:comments>8</slash:comments>
		
		
			</item>
		<item>
		<title>State of React #2 &#8211; From Inception to Redux</title>
		<link>/state-react-2-inception-redux/</link>
					<comments>/state-react-2-inception-redux/#comments</comments>
		
		<dc:creator><![CDATA[James K Nelson]]></dc:creator>
		<pubDate>Sat, 06 Aug 2016 09:12:58 +0000</pubDate>
				<category><![CDATA[Javascript]]></category>
		<category><![CDATA[React]]></category>
		<category><![CDATA[Redux]]></category>
		<category><![CDATA[State Of React]]></category>
		<guid isPermaLink="false">/?p=1039</guid>

					<description><![CDATA[<p>Welcome back to the second instalment of State of React! In case you missed it, the first instalment demonstrated a small app without component state. And it received a bunch of interesting responses, like this one from @metapgmr: using props as state and claiming that components are &#8230; stateless! The React Emperor has no clothes... <a class="more-link" href="/state-react-2-inception-redux/">Continue reading <span class="meta-nav">&#8594;</span></a></p>
<p>The post <a rel="nofollow" href="/state-react-2-inception-redux/">State of React #2 &#8211; From Inception to Redux</a> appeared first on <a rel="nofollow" href="/">James K Nelson</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>Welcome back to the second instalment of State of React! In case you missed it, the <a href="/state-react-1-stateless-react-app/">first instalment</a> demonstrated <a href="https://jsfiddle.net/jamesknelson/8acuh8e0/1/">a small app</a> without component state. And it received a bunch of interesting responses, like this one from <a href="https://twitter.com/metapgmr">@metapgmr</a>:</p>
<blockquote>
<p>using props as state and claiming that components are &#8230; stateless! The React Emperor has no clothes</p>
</blockquote>
<p>Yes, the app was basically wearing its birthday suit. And yes, the app <em>did</em> contain state. But no, the state wasn&#8217;t in the props &#8211; and it wasn&#8217;t component state either.</p>
<p>So what was it?</p>
<p><span id="more-1039"></span></p>
<p>In case you missed it, here is the &#8220;React Inception&#8221; pattern (thanks for the great name, <a href="https://twitter.com/mctaylorpants/status/761002705762471936">@mctaylorpants</a>):</p>
<pre><code>class CommentForm extends React.Component {
    static propTypes = {
        value: React.PropTypes.object.isRequired,
        onChange: React.PropTypes.func.isRequired,
    }

    handleChange(field, e) {
        this.props.onChange({
            ...this.props.value,
            [field]: e.target.value,
        })
    }

    render() {
        return (
            &lt;div&gt;
                &lt;input
                    placeholder="Name"
                    value={this.props.value.name}
                    onChange={this.handleChange.bind(this, 'name')}
                /&gt;
                &lt;input
                    placeholder="Message"
                    value={this.props.value.message}
                    onChange={this.handleChange.bind(this, 'message')}
                /&gt;
            &lt;/div&gt;
        )
    }
}

// Handle updated values by re-rendering the app
function render(value) {
    ReactDOM.render(
        &lt;CommentForm
            value={value}
            onChange={render}
        /&gt;,
        document.getElementById("react-app")
    )
}

// Initialise the app by rendering it
render({
    name: "James",
    message: "",
})
</code></pre>
<p>Think you know where the state is stored? Check your answer by touching or hovering your mouse over this box:</p>
<div class="spoiler">
<div class="spoiler-mask"></div>
The state is stored in the DOM. By calling <code>ReactDOM.render</code> with the new value, we write it to the DOM. The DOM then merges it with the requested changes on every keystroke, and passes it back to the app via an <code>onChange</code> handler.
</div>
<p>Okay. So the app isn&#8217;t stateless. That means the pattern is basically useless, right?</p>
<p>Not so fast. As I mentioned last week, having all our state in one place is pretty handy. But that brings us to the bonus question:</p>
<h2>So why don&#8217;t people do this?</h2>
<p>I&#8217;d try and explain this, but Joe Shelby beat me to the punch in a <a href="/state-react-1-stateless-react-app/#comment-22402">comment</a> on last week&#8217;s article:</p>
<blockquote>
<p>When you get to large apps, having EVERY single component look through the part of the ‘value’ object to see if anything has changed would be impressively slow.</p>
</blockquote>
<p>To get an idea of why this is, you need to remember that every JSX statement in a React file is <a href="/learned-stop-worrying-love-jsx/">actually a function call</a>, which creates a <code>ReactElement</code> object.</p>
<p>By rendering your page from the root, you need to run the <code>render</code> method of every component on your page. Which will <em>then</em> create a new <code>ReactElement</code> object for every JSX element on your page. <em>Which will then then be diffed with all the React Elements on the previous version of your page</em>. And all you wanted to do was add an <code>active</code> class to your spinner div.</p>
<p>This is a big reason why people use <code>setState</code> in the real world. <code>setState</code> lets you update a <em>subtree</em> of your react app, without re-rendering the whole thing. But it also lets you use react-router.</p>
<h2>What has react-router got to do with <code>setState</code>?</h2>
<p>If you&#8217;ve ever used <a href="https://github.com/reactjs/react-router">react-router</a>, one of the things you may have noticed is that it doesn&#8217;t let you pass <code>props</code> to your components. Instead, you need to pass components. Here is an example from the docs:</p>
<pre><code>ReactDOM.render((
  &lt;Router history={browserHistory}&gt;
    &lt;Route path="/" component={App}&gt;
      &lt;Route path="about" component={About}/&gt;
      &lt;Route path="*" component={NoMatch}/&gt;
    &lt;/Route&gt;
  &lt;/Router&gt;
), document.getElementById('root'))
</code></pre>
<p>In this example, <code>App</code>, <code>About</code> and <code>NoMatch</code> are all React Components &#8211; i.e. the objects returned by <code>React.createClass</code>, or classes which extend <code>React.Component</code>. By passing components to routes, you&#8217;re able to easily configure routes at the very root of your application. But by <em>only</em> being able to pass components to routes, you also lose the ability to pass props from the parent component without using <code>context</code>.</p>
<p>I&#8217;m not going to get into the merits/demerits of designing a router this way. But I will say that one consequence of doing things this way is that it removes the possibility of building your app using props passed all the way from the root. This means that the React Inception pattern <em>won&#8217;t work</em>. And honestly, this probably factors more into people&#8217;s decision to avoid the pattern than performance does.</p>
<p>So to summarise &#8211; the React Inception pattern is a fun novelty which doesn&#8217;t really have any place in the real world. Except that you may already be using it without realising it &#8212; just modified in a way to negate these issues.</p>
<h2>Making React Inception Useful</h2>
<p>To fix the two issues mentioned above, we&#8217;ll need to make two changes:</p>
<ol>
<li>We&#8217;ll need to split our <code>render</code> function into two parts &#8212; one to <em>make</em> changes to state, and one to <em>handle</em> changes in that state.</li>
<li>We&#8217;ll need to make it possible to <em>update</em> the state instead of <em>replacing</em> it, as updates from one part of the application shouldn&#8217;t affect state used by other parts of the application.</li>
</ol>
<p>Simple, right? And the implementation is even simpler:</p>
<pre><code>class Store {
  constructor() {
    this.listeners = []
    this.state = {}
  }

  subscribe(listener) {
    this.listeners.push(listener)

    // Return a function allowing us to unsubscribe
    return () =&gt; this.listeners.splice(this.listeners.indexOf(listener), 1)
  }

  updateState = (updates) =&gt; {
    this.state = Object.assign({}, this.state, updates)
    for (let listener of this.listeners) {
      listener(this.state)
    }
  }
}

const store = new Store()
</code></pre>
<p>To use the <code>store</code>, pass its <code>updateState</code> method through to components which need to store state. And then use <code>subscribe</code> to pass the latest version of the state into the components.</p>
<p>As an example, this is how we&#8217;d implement our familiar React Inception pattern using a <code>Store</code>:</p>
<pre><code>store.subscribe(state =&gt; {
  ReactDOM.render(
    &lt;CommentForm
        value={state}
        onChange={store.updateState}
    /&gt;,
    document.getElementById("react-app")
  )
})

// Set initial state
store.updateState({
    name: "James",
    message: "",
})
</code></pre>
<p>But this just makes our existing code more complicated. What we <em>really</em> want to do is connect our store up to a component <em>inside</em> the application, speeding up our app and getting our data past react-router without using <code>props</code>.</p>
<p>To do so, let&#8217;s follow Dan Abramov&#8217;s <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.rjjwfiegh">Containers pattern</a>. This is akin to creating a &#8220;sub-application&#8221; which uses <code>setState</code> to store the data for a group of state-free child components &#8212; like the <code>CommentForm</code> from our previous app.</p>
<pre><code>class CommentFormContainer extends React.Component {
  componentDidMount() {
    this.unsubscribe = store.subscribe(state =&gt; {
      this.setState(state.CommentFormContainer)
    })
  }

  componentWillUnmount() {
    if (this.unsubscribe) {
      this.unsubscribe()
    }
  }

  handleChange(value) {
    store.updateState({ CommentFormContainer: value })
  }

  render() {
    return (
      &lt;CommentForm
        value={this.state}
        onChange={this.handleChange}
      /&gt;
    )
  }
}
</code></pre>
<p>Now place this Container somewhere inside an existing application and <em>presto</em> &#8212; (almost) stateless sub-app.</p>
<h2>Wait a moment &#8211; haven&#8217;t I seen this before?</h2>
<p>Container components? Aren&#8217;t they a Redux thing? And stores with a <code>subscribe</code> method which hold the application state at the root of the app?</p>
<p>So I admit it. I&#8217;ve basically made a shit version of Redux.</p>
<p>Honestly, I wouldn&#8217;t use the code I&#8217;ve written above &#8212; Redux is better. Reasons:</p>
<ul>
<li>Instead of allowing direct mutation of the stored state, it forces you to write <a href="http://redux.js.org/docs/basics/Actions.html">actions</a> and <a href="http://redux.js.org/docs/basics/Reducers.html">reducers</a> which make it easier to understand what-the-hell is going on.</li>
<li>Redux gives you the <code>connect</code> function to automate creation of container components (my container above is based on the internals of <code>connect</code>).</li>
<li>It gives you extensibility via <a href="http://redux.js.org/docs/advanced/Middleware.html">middleware</a>, and a whole bunch of neat <a href="https://github.com/gaearon/redux-devtools">tooling</a>.</li>
</ul>
<p>So what I&#8217;m saying is that if you want to manage state, <em>Redux is the bees knees</em>. By putting it all in one place, it becomes possible to share state between Containers and cache data between page views. And by keeping most of your components stateless, testing and design becomes a breeze.</p>
<p>But while Redux does a great job of <em>managing</em> your state, it still leaves you with the problem of <em>structuring</em> it.</p>
<h1>5 Types of state</h1>
<p>I have a theory: to understand how to <em>structure</em> state, you first need to understand where the state actually is.</p>
<p>As far as I can tell, there are five types of state &#8212; and the best way to structure state depends on which of the types it falls under.</p>
<p>Want to find out what the types are, and the patterns for structuring them? Then subscribe to my newsletter now to make sure you don&#8217;t miss the next instalment of State of React! And in return for your e-mail, you&#8217;ll immediately receive <em>five</em> free ReactJS and JavaScript cheatsheets!</p>
<script src="https://app.convertkit.com/assets/CKJS4.js?v=21"></script>

<div class="ck_form ck_vertical_subscription_form">
  <div class="ck_form_content">
      <h3 class="ck_form_title">I will send you useful articles, cheatsheets and code.</h3>
      <div class="ck_description">
          I won't send you useless inbox filler. <em>No spam, ever.</em>
      </div>
  </div>

  <div class="ck_form_fields">

    <div id='ck_success_msg'  style='display:none;'>
      <p>Thanks! Please check your email for the link to your cheatsheets.</p>
    </div>

    <!--  Form starts here  -->
    <form id="ck_subscribe_form" class="ck_subscribe_form" action="https://app.convertkit.com/landing_pages/4375/subscribe" data-remote="true">
      <input type="hidden" value="{&quot;embed_style&quot;:&quot;inline&quot;,&quot;embed_trigger&quot;:&quot;scroll_percentage&quot;,&quot;scroll_percentage&quot;:&quot;70&quot;,&quot;delay_seconds&quot;:&quot;10&quot;,&quot;display_position&quot;:&quot;br&quot;,&quot;display_devices&quot;:&quot;all&quot;,&quot;days_no_show&quot;:&quot;15&quot;,&quot;converted_behavior&quot;:&quot;show&quot;}" id="ck_form_options"></input>
      <input type="hidden" name="id" value="4375" id="landing_page_id"></input>
      <div class="ck_errorArea">
        <div id="ck_error_msg" style="display:none">
          <p>There was an error submitting your subscription. Please try again.</p>
        </div>
      </div>
      <div class="ck_control_group ck_first_name_field_group">
        <label class="ck_label" for="ck_firstNameField">First Name</label>
        <input type="text" name="first_name" class="ck_first_name" id="ck_firstNameField"></input>
      </div>
      <div class="ck_control_group ck_email_field_group">
        <label class="ck_label" for="ck_emailField">Email Address</label>
          <input type="email" name="email" class="ck_email_address" id="ck_emailField" required></input>
      </div>
      <label class='ck_checkbox' style='display:none;'>
        <input class="optIn ck_course_opted" name='course_opted' type="checkbox" id="optIn" checked />
        <span class='ck_opt_in_prompt'>I'd like to receive the free email course.</span>
      </label>

      <button class="subscribe_button ck_subscribe_button btn fields" id='ck_subscribe_button'>
       Join over 13,000 subscribers
      </button>
      <span class="ck_guarantee">
        Unsubscribe at any time.
      </span>
    </form>
  </div>

 </div>


<style type="text/css">/* Layout */
  .ck_form {
  /* divider image */
  background: #fff url(data:image/gif;base64,R0lGODlhAQADAIABAMzMzP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MUQ5NjM5RjgxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MUQ5NjM5RjkxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxRDk2MzlGNjFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxRDk2MzlGNzFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAABAAMAAAICRFIAOw==) repeat-y center top;
  font-family: 'Helvetica Neue', Helvetica, Arial, Verdana, sans-serif;
  line-height: 1.5em;
  overflow: hidden;
  color: #666;
  font-size: 16px;
  border-top: solid 20px #3071b0;
  border-top-color: #b30e2f;
  border-bottom: solid 10px #3d3d3d;
  border-bottom-color: #5f0719;
  -webkit-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  -moz-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  clear: both;
  margin: 20px 0px;
}

.ck_form * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

#ck_subscribe_form {
  clear: both;
}

/* Element Queries — uses JS */

.ck_form_content, .ck_form_fields {
  width: 50%;
  float: left;
  padding: 5%;
}

.ck_form.ck_horizontal {
}

.ck_form_content {
  border-bottom: none;
}

.ck_form.ck_vertical {
  background: #fff;
}

.ck_vertical .ck_form_content, .ck_vertical .ck_form_fields {
  padding: 10%;
  width: 100%;
  float: none;
}

.ck_vertical .ck_form_content {
  border-bottom: 1px dotted #aaa;
  overflow: hidden;
}

/* Trigger the vertical layout with media queries as well */

@media all and (max-width: 499px) {

  .ck_form {
    background: #fff;
  }

  .ck_form_content, .ck_form_fields {
    padding: 10%;
    width: 100%;
    float: none;
  }

  .ck_form_content {
    border-bottom: 1px dotted #aaa;
  }

}

/* Content */

.ck_form_content h3 {
  margin: 0px 0px 15px;
  font-size: 24px;
  padding: 0px;
}


.ck_form_content p {
  font-size: 14px;
}

.ck_image {
  float: left;
  margin-right: 5px;
}

/* Form fields */

.ck_errorArea {
  display: none;
}

#ck_success_msg {
  padding: 10px 10px 0px;
  border: solid 1px #ddd;
  background: #eee;
}

.ck_label {
  font-size: 14px;
  font-weight: bold;
}

.ck_form input[type="text"], .ck_form input[type="email"] {
  font-size: 14px;
  padding: 10px 8px;
  width: 100%;
  border: 1px solid #d6d6d6; /* stroke */
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  border-radius: 4px; /* border radius */
  background-color: #f8f7f7; /* layer fill content */
  margin-bottom: 5px;
  height: auto;
}

.ck_form input[type="text"]:focus, .ck_form input[type="email"]:focus {
  outline: none;
  border-color: #aaa;
}

.ck_checkbox {
  padding: 10px 0px 10px 20px;
  display: block;
  clear: both;
}

.ck_checkbox input.optIn {
  margin-left: -20px;
  margin-top: 0;
}
.ck_form .ck_opt_in_prompt {
  margin-left: 4px;
}
.ck_form .ck_opt_in_prompt p {
  display: inline;
}

.ck_form .ck_subscribe_button {
    width: 100%;
    color: #fff;
    margin: 10px 0px 0px;
    padding:  10px 0px;
    font-size: 18px;
    background: #b30e2f;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px; /* border radius */
    cursor: pointer;
    border: none;
    text-shadow: none;
  }


.ck_form .ck_guarantee {
  color: #626262;
  font-size: 12px;
  text-align: center;
  padding: 5px 0px;
  display: block;
}

.ck_form .ck_powered_by {
  display: block;
  color: #aaa;
}

.ck_form .ck_powered_by:hover {
  display: block;
  color: #444;
}

.ck_converted_content {
  display: none;
  padding: 5%;
  background: #fff;
}



</style>
<p>One more thing &#8211; <em>I love hearing your questions, offers and opinions.</em> If you have something to say, leave a comment or send me an e-mail at <a href="mailto:james@jamesknelson.com">james@jamesknelson.com</a>. I&#8217;m looking forward to hearing from you!</p>
<p>The post <a rel="nofollow" href="/state-react-2-inception-redux/">State of React #2 &#8211; From Inception to Redux</a> appeared first on <a rel="nofollow" href="/">James K Nelson</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>/state-react-2-inception-redux/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>State of React #1: A Stateless React App?</title>
		<link>/state-react-1-stateless-react-app/</link>
					<comments>/state-react-1-stateless-react-app/#comments</comments>
		
		<dc:creator><![CDATA[James K Nelson]]></dc:creator>
		<pubDate>Sun, 31 Jul 2016 07:14:39 +0000</pubDate>
				<category><![CDATA[Javascript]]></category>
		<category><![CDATA[React]]></category>
		<category><![CDATA[State Of React]]></category>
		<guid isPermaLink="false">/?p=1031</guid>

					<description><![CDATA[<p>Have you ever been frustrated with the task of making loading spinners appear at the right time? Or maybe you&#8217;ve had trouble making a popup appear when and where you want it? These are both signs that your code suffers from unmanaged state &#8212; the bane of basically every web developer on the planet. And... <a class="more-link" href="/state-react-1-stateless-react-app/">Continue reading <span class="meta-nav">&#8594;</span></a></p>
<p>The post <a rel="nofollow" href="/state-react-1-stateless-react-app/">State of React #1: A Stateless React App?</a> appeared first on <a rel="nofollow" href="/">James K Nelson</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>Have you ever been frustrated with the task of making loading spinners appear at the right time? Or maybe you&#8217;ve had trouble making a popup appear when and where you want it? These are both signs that your code suffers from <em>unmanaged state</em> &#8212; the bane of basically every web developer on the planet.</p>
<p>And luckily, the React ecosystem is brimming with tools to help. <a href="http://redux.js.org/">Redux</a>, <a href="https://mobxjs.github.io/mobx/">MobX</a>, <a href="https://facebook.github.io/react/docs/flux-overview.html">Flux</a> and <a href="http://qiita.com/kimagure/items/22cf4bb2a967fcba376e">RxJS</a> are just a few. And while they have a number of things in common (including for some reason the letter &#8220;x&#8221;), the one which stands out the most is that they just convert the problem of &#8220;managing&#8221; state into the problem of &#8220;structuring it&#8221;.</p>
<p>But if it seems that there is no way to dull the state of pain, it begs the question &#8212; instead of <em>managing</em> our state, why don&#8217;t we just avoid it?</p>
<p><span id="more-1031"></span></p>
<h2>But how?</h2>
<p>Well, given a React app generally stores most of its state with <code>setState</code>, it stands to reason that the first thing we&#8217;d want to do is ban it.</p>
<p>By definition, this means that if we had a form, we&#8217;d need to pass any changes back up to the root of the application via callbacks. And we&#8217;d also need to pass any new values down the tree via <code>props</code>.</p>
<p>We&#8217;d also rule out the use of <a href="https://facebook.github.io/react/docs/forms.html#uncontrolled-components">uncontrolled components</a>, as they&#8217;re inherently stateful.</p>
<p>This would leave something like this:</p>
<pre><code>class CommentForm extends React.Component {
    static propTypes = {
        value: React.PropTypes.object.isRequired,
        onChange: React.PropTypes.func.isRequired,
    }

    handleChange(field, e) {
        this.props.onChange({
            ...this.props.value,
            [field]: e.target.value,
        })
    }

    render() {
        return (
            &lt;div&gt;
                &lt;input
                    placeholder="Name"
                    value={this.props.value.name}
                    onChange={this.handleChange.bind(this, 'name')}
                /&gt;
                &lt;input
                    placeholder="Message"
                    value={this.props.value.message}
                    onChange={this.handleChange.bind(this, 'message')}
                /&gt;
            &lt;/div&gt;
        )
    }
}
</code></pre>
<h2>It&#8217;s a form? No wait, it&#8217;s an input?</h2>
<p>Notice how the <code>ContactForm</code> has the same signature as the inputs inside it? By structuring our format to take and emit Contact objects via its <code>value</code> prop and <code>onChange</code> callback, we&#8217;ve basically made a &#8220;Contact Input&#8221;. This form is to Contact objects as an <code>&lt;input&gt;</code> is to strings.</p>
<p>By itself, this is nothing special &#8211; but let me throw this at you. If a Contact input can be created from a number of string inputs, can an Invoice input be created from a Contact input, a number of Line Item inputs, and etc.?</p>
<p>The answer, of course, is yes. And the cool part is that this pattern isn&#8217;t just limited to forms. For example, we could use a similar pattern of nested callbacks and objects to hold an entire application worth of data.</p>
<p>But whether we&#8217;ve banned <code>setState</code> from a single form or an entire application, we&#8217;re still going to have <code>props</code> on the root object which hold the app&#8217;s callbacks and data:</p>
<pre><code>ReactDOM.render(
    &lt;CommentForm
        value={...}
        onChange={...}
    /&gt;,
    document.getElementById("react-app")
)
</code></pre>
<p>And whatever are we going to do with these?</p>
<h2>Takes a value, emits changed values</h2>
<p>Well, since our <code>value</code> prop takes exactly the same format as the <code>onChange</code> callback emits, why don&#8217;t we just plug them into each other?</p>
<pre><code>// Handle updated values by re-rendering the app
function render(value) {
    ReactDOM.render(
        &lt;CommentForm
            value={value}
            onChange={render}
        /&gt;,
        document.getElementById("react-app")
    )
}

// Initialise the app by rendering it
render({
    name: "James",
    message: "",
})
</code></pre>
<p>Don&#8217;t believe its possible? Check for yourself with <a href="https://jsfiddle.net/jamesknelson/8acuh8e0/1/">this JSBin</a>.</p>
<h2>Look Ma, No Component State!</h2>
<p>By calling <code>render</code> every time anything changes, we ensure our changes are visible, without storing them within <em>any</em> React component&#8217;s state.</p>
<p>And just to cap things off, we have access to enough information to render the <em>entire</em> application at any point in the app&#8217;s life cycle, all within that single <code>value</code> object. That surely has to be useful.</p>
<p>But wait a minute. If this solves all our problems, why does it seem nobody is doing anything this way? And doesn&#8217;t having enough information to render our application stored within <code>value</code> sound suspiciously like state?</p>
<p><strong>So my question to you is: does this app have state? And if so, where is it?</strong></p>
<p>And the bonus question: <em>Why don&#8217;t more apps follow this pattern?</em></p>
<p>Tweet your responses on hash tag <a href="https://twitter.com/search?f=tweets&amp;q=%23stateofreact&amp;src=typd">#stateofreact</a>, and I&#8217;ll respond in next week&#8217;s episode of <em>State Of React</em>! Sign up to my newsletter to make sure you don&#8217;t miss out &#8212; and grab a bunch of exclusive cheat sheets while you&#8217;re at it:</p>
<script src="https://app.convertkit.com/assets/CKJS4.js?v=21"></script>

<div class="ck_form ck_vertical_subscription_form">
  <div class="ck_form_content">
      <h3 class="ck_form_title">I will send you useful articles, cheatsheets and code.</h3>
      <div class="ck_description">
          I won't send you useless inbox filler. <em>No spam, ever.</em>
      </div>
  </div>

  <div class="ck_form_fields">

    <div id='ck_success_msg'  style='display:none;'>
      <p>Thanks! Please check your email for the link to your cheatsheets.</p>
    </div>

    <!--  Form starts here  -->
    <form id="ck_subscribe_form" class="ck_subscribe_form" action="https://app.convertkit.com/landing_pages/4375/subscribe" data-remote="true">
      <input type="hidden" value="{&quot;embed_style&quot;:&quot;inline&quot;,&quot;embed_trigger&quot;:&quot;scroll_percentage&quot;,&quot;scroll_percentage&quot;:&quot;70&quot;,&quot;delay_seconds&quot;:&quot;10&quot;,&quot;display_position&quot;:&quot;br&quot;,&quot;display_devices&quot;:&quot;all&quot;,&quot;days_no_show&quot;:&quot;15&quot;,&quot;converted_behavior&quot;:&quot;show&quot;}" id="ck_form_options"></input>
      <input type="hidden" name="id" value="4375" id="landing_page_id"></input>
      <div class="ck_errorArea">
        <div id="ck_error_msg" style="display:none">
          <p>There was an error submitting your subscription. Please try again.</p>
        </div>
      </div>
      <div class="ck_control_group ck_first_name_field_group">
        <label class="ck_label" for="ck_firstNameField">First Name</label>
        <input type="text" name="first_name" class="ck_first_name" id="ck_firstNameField"></input>
      </div>
      <div class="ck_control_group ck_email_field_group">
        <label class="ck_label" for="ck_emailField">Email Address</label>
          <input type="email" name="email" class="ck_email_address" id="ck_emailField" required></input>
      </div>
      <label class='ck_checkbox' style='display:none;'>
        <input class="optIn ck_course_opted" name='course_opted' type="checkbox" id="optIn" checked />
        <span class='ck_opt_in_prompt'>I'd like to receive the free email course.</span>
      </label>

      <button class="subscribe_button ck_subscribe_button btn fields" id='ck_subscribe_button'>
       Join over 13,000 subscribers
      </button>
      <span class="ck_guarantee">
        Unsubscribe at any time.
      </span>
    </form>
  </div>

 </div>


<style type="text/css">/* Layout */
  .ck_form {
  /* divider image */
  background: #fff url(data:image/gif;base64,R0lGODlhAQADAIABAMzMzP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MUQ5NjM5RjgxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MUQ5NjM5RjkxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxRDk2MzlGNjFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxRDk2MzlGNzFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAABAAMAAAICRFIAOw==) repeat-y center top;
  font-family: 'Helvetica Neue', Helvetica, Arial, Verdana, sans-serif;
  line-height: 1.5em;
  overflow: hidden;
  color: #666;
  font-size: 16px;
  border-top: solid 20px #3071b0;
  border-top-color: #b30e2f;
  border-bottom: solid 10px #3d3d3d;
  border-bottom-color: #5f0719;
  -webkit-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  -moz-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  box-shadow: 0px 0px 5px rgba(0,0,0,.3);
  clear: both;
  margin: 20px 0px;
}

.ck_form * {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

#ck_subscribe_form {
  clear: both;
}

/* Element Queries — uses JS */

.ck_form_content, .ck_form_fields {
  width: 50%;
  float: left;
  padding: 5%;
}

.ck_form.ck_horizontal {
}

.ck_form_content {
  border-bottom: none;
}

.ck_form.ck_vertical {
  background: #fff;
}

.ck_vertical .ck_form_content, .ck_vertical .ck_form_fields {
  padding: 10%;
  width: 100%;
  float: none;
}

.ck_vertical .ck_form_content {
  border-bottom: 1px dotted #aaa;
  overflow: hidden;
}

/* Trigger the vertical layout with media queries as well */

@media all and (max-width: 499px) {

  .ck_form {
    background: #fff;
  }

  .ck_form_content, .ck_form_fields {
    padding: 10%;
    width: 100%;
    float: none;
  }

  .ck_form_content {
    border-bottom: 1px dotted #aaa;
  }

}

/* Content */

.ck_form_content h3 {
  margin: 0px 0px 15px;
  font-size: 24px;
  padding: 0px;
}


.ck_form_content p {
  font-size: 14px;
}

.ck_image {
  float: left;
  margin-right: 5px;
}

/* Form fields */

.ck_errorArea {
  display: none;
}

#ck_success_msg {
  padding: 10px 10px 0px;
  border: solid 1px #ddd;
  background: #eee;
}

.ck_label {
  font-size: 14px;
  font-weight: bold;
}

.ck_form input[type="text"], .ck_form input[type="email"] {
  font-size: 14px;
  padding: 10px 8px;
  width: 100%;
  border: 1px solid #d6d6d6; /* stroke */
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  border-radius: 4px; /* border radius */
  background-color: #f8f7f7; /* layer fill content */
  margin-bottom: 5px;
  height: auto;
}

.ck_form input[type="text"]:focus, .ck_form input[type="email"]:focus {
  outline: none;
  border-color: #aaa;
}

.ck_checkbox {
  padding: 10px 0px 10px 20px;
  display: block;
  clear: both;
}

.ck_checkbox input.optIn {
  margin-left: -20px;
  margin-top: 0;
}
.ck_form .ck_opt_in_prompt {
  margin-left: 4px;
}
.ck_form .ck_opt_in_prompt p {
  display: inline;
}

.ck_form .ck_subscribe_button {
    width: 100%;
    color: #fff;
    margin: 10px 0px 0px;
    padding:  10px 0px;
    font-size: 18px;
    background: #b30e2f;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px; /* border radius */
    cursor: pointer;
    border: none;
    text-shadow: none;
  }


.ck_form .ck_guarantee {
  color: #626262;
  font-size: 12px;
  text-align: center;
  padding: 5px 0px;
  display: block;
}

.ck_form .ck_powered_by {
  display: block;
  color: #aaa;
}

.ck_form .ck_powered_by:hover {
  display: block;
  color: #444;
}

.ck_converted_content {
  display: none;
  padding: 5%;
  background: #fff;
}



</style>
<p><em>Update: <a href="/state-react-2-inception-redux/">Part 2</a> is now out!</em></p>
<p>One more thing &#8211; <em>I love hearing your questions, offers and opinions.</em> If you have something to say, leave a comment or send me an e-mail at <a href="mailto:james@jamesknelson.com">james@jamesknelson.com</a>. I&#8217;m looking forward to hearing from you!</p>
<p>The post <a rel="nofollow" href="/state-react-1-stateless-react-app/">State of React #1: A Stateless React App?</a> appeared first on <a rel="nofollow" href="/">James K Nelson</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>/state-react-1-stateless-react-app/feed/</wfw:commentRss>
			<slash:comments>11</slash:comments>
		
		
			</item>
	</channel>
</rss>
